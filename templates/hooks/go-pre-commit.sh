#!/bin/sh
# Go Pre-Commit Hook
# Generated by @hivellm/rulebook

echo "ğŸ” Running Go pre-commit checks..."

# Format check
echo "  â†’ Format checking..."
if [ "$(gofmt -l . | wc -l)" -gt 0 ]; then
  echo "âŒ Go files not formatted. Run: gofmt -w ."
  gofmt -l .
  exit 1
fi

# Vet
echo "  â†’ Running go vet..."
go vet ./... || {
  echo "âŒ go vet failed"
  exit 1
}

# Lint (if golangci-lint available)
if command -v golangci-lint &> /dev/null; then
  echo "  â†’ Linting..."
  golangci-lint run || {
    echo "âŒ Linting failed"
    exit 1
  }
fi

# Tests
echo "  â†’ Running tests..."
go test ./... || {
  echo "âŒ Tests failed"
  exit 1
}

echo "âœ… All Go pre-commit checks passed!"
exit 0

