#!/bin/sh
# Haskell Pre-Commit Hook
# Generated by @hivellm/rulebook

echo "ğŸ” Running Haskell pre-commit checks..."

# Lint
if command -v hlint &> /dev/null; then
  echo "  â†’ Linting..."
  hlint . || {
    echo "âŒ HLint failed"
    exit 1
  }
fi

# Format check (if ormolu available)
if command -v ormolu &> /dev/null; then
  echo "  â†’ Format checking..."
  ormolu --mode check $(find . -name '*.hs') || {
    echo "âŒ Format check failed. Run: ormolu --mode inplace \$(find . -name '*.hs')"
    exit 1
  }
fi

# Tests
echo "  â†’ Running tests..."
if [ -f "stack.yaml" ]; then
  stack test || {
    echo "âŒ Tests failed"
    exit 1
  }
else
  cabal test || {
    echo "âŒ Tests failed"
    exit 1
  }
fi

echo "âœ… All Haskell pre-commit checks passed!"
exit 0

