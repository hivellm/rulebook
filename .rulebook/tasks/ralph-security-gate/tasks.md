# Tasks: Ralph Security Gate

- [ ] Add `SecurityGateConfig` type in `src/types.ts`
- [ ] Add `ralph.securityGate` schema to config-manager.ts with defaults
- [ ] Implement `detectAvailableSecurityTool(projectRoot)` — check npm-audit, trivy, semgrep
- [ ] Implement `runSecurityGate(projectRoot, config)` in agent-manager.ts
- [ ] Implement `npm audit --json` runner and CRITICAL/HIGH/MODERATE parser
- [ ] Implement trivy runner and parser (if trivy available)
- [ ] Implement semgrep runner and parser (if semgrep available)
- [ ] Add `parseSecurityOutput(tool, output)` to `ralph-parser.ts`
- [ ] Wire security gate as 5th gate in Ralph iteration flow
- [ ] Add `securityGate` to `QualityCheckResult` structure
- [ ] Add `ralph.securityGate.enabled` config option (default: true)
- [ ] Add `ralph.securityGate.failOn` config option (default: "high")
- [ ] Skip gate gracefully if no security tool available (warn, don't fail)
- [ ] Update RALPH.md template to document security gate
- [ ] Write tests: npm audit HIGH → gate fails
- [ ] Write tests: npm audit MODERATE only → gate passes (default config)
- [ ] Write tests: no tool available → gate skipped with warning
- [ ] Write tests: securityGate.enabled=false → gate skipped
- [ ] Run full test suite
